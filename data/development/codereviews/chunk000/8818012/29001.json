{"files":{"media/audio/test_audio_input_controller_factory.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":2,"messages":[],"id":30061,"is_binary":false},"media/tools/player_wtl/movie.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":3,"num_removed":1,"messages":[],"id":30069,"is_binary":false},"media/filters/reference_audio_renderer.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":3,"messages":[],"id":30066,"is_binary":false},"content/browser/resource_context.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":15,"num_removed":1,"messages":[],"id":30023,"is_binary":false},"media/audio/audio_output_dispatcher.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":38,"num_removed":8,"messages":[],"id":30048,"is_binary":false},"media/audio/test_audio_input_controller_factory.h":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":0,"messages":[],"id":30062,"is_binary":false},"chrome/browser/speech/chrome_speech_input_manager.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":14,"num_removed":5,"messages":[],"id":30005,"is_binary":false},"chrome/test/base/testing_browser_process.h":{"status":"M    ","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":30011,"is_binary":false},"media/tools/player_x11/player_x11.cc":{"status":"M    ","num_chunks":8,"no_base_file":false,"property_changes":"","num_added":18,"num_removed":7,"messages":[],"id":30070,"is_binary":false},"content/browser/renderer_host/media/audio_input_device_manager.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":3,"messages":[],"id":30012,"is_binary":false},"media/audio/audio_manager.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":23,"num_removed":23,"messages":[],"id":30042,"is_binary":false},"media/audio/audio_output_controller.cc":{"status":"M    ","num_chunks":9,"no_base_file":false,"property_changes":"","num_added":33,"num_removed":34,"messages":[],"id":30045,"is_binary":false},"media/filters/reference_audio_renderer.h":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":3,"messages":[],"id":30067,"is_binary":false},"content/browser/renderer_host/media/video_capture_host_unittest.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":1,"messages":[],"id":30021,"is_binary":false},"media/audio/audio_output_proxy_unittest.cc":{"status":"M    ","num_chunks":12,"no_base_file":false,"property_changes":"","num_added":19,"num_removed":13,"messages":[],"id":30052,"is_binary":false},"media/audio/audio_output_controller.h":{"status":"M    ","num_chunks":8,"no_base_file":false,"property_changes":"","num_added":25,"num_removed":4,"messages":[],"id":30046,"is_binary":false},"chrome/browser/profiles/profile_io_data.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":3,"num_removed":1,"messages":[{"author":"willchan","author_email":"willchan@chromium.org","text":"Can you make audio_manager get passed in on the UI thread? There's actually a small race since g_browser_process is a UI thread object and we're accessing it on the IO thread. If the process shutdown immediately, it's actually theoretically possible for this to be a use after free.\n\nAlso, I like to push use of globals as close to main() as possible, and pass them into code.","draft":false,"lineno":500,"date":"2011-12-10 00:27:33.768353","left":false},{"author":"tommi","author_email":"tommi@chromium.org","text":"On 2011/12/10 00:27:33, willchan wrote:\n> Can you make audio_manager get passed in on the UI thread? There's actually a\n> small race since g_browser_process is a UI thread object and we're accessing it\n> on the IO thread. If the process shutdown immediately, it's actually\n> theoretically possible for this to be a use after free.\n\nJust so that I understand - do you mean that g_browser_process might possibly be invalid or that the audio manager might be used after BrowserProcessImpl releases its reference?\n\nWhat I'll do then is to fetch the audio_manager inside InitializeOnUIThread and pass it to here via profile_params_.  Sounds reasonable?\n\n> \n> Also, I like to push use of globals as close to main() as possible, and pass\n> them into code.\n\nIs there perhaps a better way to share an object across more than one ResourceContext instances than to keep it with BrowserProcessImpl?  If there is, I can move the audio manager's home when I make the change to not have the audio manager ref counted.","draft":false,"lineno":500,"date":"2011-12-10 09:59:57.351404","left":false},{"author":"willchan","author_email":"willchan@chromium.org","text":"On 2011/12/10 09:59:57, tommi wrote:\n> On 2011/12/10 00:27:33, willchan wrote:\n> > Can you make audio_manager get passed in on the UI thread? There's actually a\n> > small race since g_browser_process is a UI thread object and we're accessing\n> it\n> > on the IO thread. If the process shutdown immediately, it's actually\n> > theoretically possible for this to be a use after free.\n> \n> Just so that I understand - do you mean that g_browser_process might possibly be\n> invalid or that the audio manager might be used after BrowserProcessImpl\n> releases its reference?\n> \n> What I'll do then is to fetch the audio_manager inside InitializeOnUIThread and\n> pass it to here via profile_params_.  Sounds reasonable?\n\nSounds great and your change looks great to me.\n\n> \n> > \n> > Also, I like to push use of globals as close to main() as possible, and pass\n> > them into code.\n> \n> Is there perhaps a better way to share an object across more than one\n> ResourceContext instances than to keep it with BrowserProcessImpl?  If there is,\n> I can move the audio manager's home when I make the change to not have the audio\n> manager ref counted.\n\n","draft":false,"lineno":500,"date":"2011-12-12 16:44:05.130850","left":false}],"id":30004,"is_binary":false},"media/audio/mac/audio_low_latency_input_mac_unittest.cc":{"status":"M    ","num_chunks":8,"no_base_file":false,"property_changes":"","num_added":48,"num_removed":45,"messages":[],"id":30058,"is_binary":false},"chrome/browser/speech/speech_input_bubble_gtk.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":14,"num_removed":6,"messages":[],"id":30007,"is_binary":false},"media/audio/audio_manager.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":23,"num_removed":23,"messages":[{"author":"scherkus","author_email":"scherkus@chromium.org","text":"!!!","draft":false,"lineno":1,"date":"2011-12-10 00:16:52.739308","left":false},{"author":"tommi","author_email":"tommi@chromium.org","text":"On 2011/12/10 00:16:52, scherkus wrote:\n> !!!\n\nDone. thanks!!!","draft":false,"lineno":1,"date":"2011-12-10 09:59:57.351700","left":false}],"id":30041,"is_binary":false},"media/audio/simple_sources_unittest.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":3,"messages":[],"id":30060,"is_binary":false},"chrome/browser/speech/speech_input_extension_manager.cc":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":8,"num_removed":7,"messages":[],"id":30009,"is_binary":false},"chrome/browser/speech/chrome_speech_input_manager.h":{"status":"M    ","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":1,"messages":[],"id":30006,"is_binary":false},"content/browser/renderer_host/media/audio_renderer_host.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":10,"num_removed":5,"messages":[],"id":30016,"is_binary":false},"media/audio/audio_output_dispatcher.h":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":26,"num_removed":15,"messages":[],"id":30049,"is_binary":false},"chrome/browser/speech/speech_input_bubble_views.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":2,"messages":[],"id":30008,"is_binary":false},"content/browser/resource_context.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":0,"messages":[],"id":30024,"is_binary":false},"content/test/webrtc_audio_device_test.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":59,"num_removed":24,"messages":[],"id":30034,"is_binary":false},"content/browser/speech/speech_recognizer.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":0,"messages":[],"id":30031,"is_binary":false},"content/browser/renderer_host/media/audio_input_device_manager_unittest.cc":{"status":"M    ","num_chunks":9,"no_base_file":false,"property_changes":"","num_added":35,"num_removed":17,"messages":[],"id":30014,"is_binary":false},"content/browser/speech/speech_input_manager.cc":{"status":"M    ","num_chunks":8,"no_base_file":false,"property_changes":"","num_added":41,"num_removed":14,"messages":[],"id":30028,"is_binary":false},"media/audio/linux/alsa_output_unittest.cc":{"status":"M    ","num_chunks":13,"no_base_file":false,"property_changes":"","num_added":18,"num_removed":13,"messages":[],"id":30055,"is_binary":false},"media/audio/linux/audio_manager_linux.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":14,"num_removed":23,"messages":[],"id":30056,"is_binary":false},"media/audio/audio_output_proxy.h":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":7,"messages":[],"id":30051,"is_binary":false},"content/test/webrtc_audio_device_test.h":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":17,"messages":[],"id":30035,"is_binary":false},"media/audio/win/audio_low_latency_output_win_unittest.cc":{"status":"M    ","num_chunks":16,"no_base_file":false,"property_changes":"","num_added":49,"num_removed":32,"messages":[],"id":30064,"is_binary":false},"chrome/browser/browser_process.h":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":3,"num_removed":0,"messages":[],"id":30001,"is_binary":false},"media/audio/audio_input_controller.cc":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":14,"num_removed":11,"messages":[],"id":30036,"is_binary":false},"chrome/browser/browser_process_impl.h":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":3,"num_removed":0,"messages":[{"author":"willchan","author_email":"willchan@chromium.org","text":"Why is this refcounted? And if this is used on the IO thread, perhaps you should make sure the destruction order is such that it gets destroyed before the IO thread gets joined.","draft":false,"lineno":290,"date":"2011-12-10 00:27:33.768069","left":false}],"id":30003,"is_binary":false},"media/tools/player_wtl/movie.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":2,"messages":[],"id":30068,"is_binary":false},"content/browser/renderer_host/media/audio_renderer_host_unittest.cc":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":22,"num_removed":6,"messages":[],"id":30017,"is_binary":false},"content/browser/speech/speech_input_browsertest.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":23,"num_removed":28,"messages":[],"id":30025,"is_binary":false},"content/browser/renderer_host/media/audio_input_renderer_host.cc":{"status":"M    ","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":1,"num_removed":0,"messages":[],"id":30015,"is_binary":false},"media/audio/audio_output_controller_unittest.cc":{"status":"M    ","num_chunks":16,"no_base_file":false,"property_changes":"","num_added":55,"num_removed":22,"messages":[],"id":30047,"is_binary":false},"media/audio/audio_input_controller_unittest.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":10,"num_removed":5,"messages":[],"id":30038,"is_binary":false},"media/audio/audio_manager_base.h":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":18,"num_removed":10,"messages":[],"id":30044,"is_binary":false},"content/renderer/media/webrtc_audio_device_unittest.cc":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":39,"messages":[],"id":30033,"is_binary":false},"chrome/test/base/testing_browser_process.cc":{"status":"M    ","num_chunks":1,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":0,"messages":[],"id":30010,"is_binary":false},"content/browser/renderer_host/media/audio_input_device_manager.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":4,"num_removed":1,"messages":[],"id":30013,"is_binary":false},"content/browser/speech/speech_input_manager.h":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":12,"num_removed":3,"messages":[],"id":30029,"is_binary":false},"media/audio/linux/alsa_input.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":9,"num_removed":1,"messages":[],"id":30054,"is_binary":false},"media/audio/win/audio_output_win_unittest.cc":{"status":"M    ","num_chunks":16,"no_base_file":false,"property_changes":"","num_added":16,"num_removed":31,"messages":[],"id":30065,"is_binary":false},"media/audio/mac/audio_output_mac_unittest.cc":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":7,"num_removed":11,"messages":[],"id":30059,"is_binary":false},"media/audio/audio_input_unittest.cc":{"status":"M    ","num_chunks":6,"no_base_file":false,"property_changes":"","num_added":24,"num_removed":20,"messages":[],"id":30040,"is_binary":false},"media/audio/win/audio_low_latency_input_win_unittest.cc":{"status":"M    ","num_chunks":10,"no_base_file":false,"property_changes":"","num_added":31,"num_removed":24,"messages":[],"id":30063,"is_binary":false},"chrome/browser/browser_process_impl.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":9,"num_removed":0,"messages":[],"id":30002,"is_binary":false},"media/audio/audio_input_controller.h":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":10,"num_removed":3,"messages":[],"id":30037,"is_binary":false},"media/audio/audio_input_device_unittest.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":14,"num_removed":34,"messages":[],"id":30039,"is_binary":false},"media/audio/linux/alsa_input.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":6,"messages":[],"id":30053,"is_binary":false},"content/browser/speech/speech_input_dispatcher_host.cc":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":8,"num_removed":3,"messages":[],"id":30026,"is_binary":false},"content/browser/speech/speech_input_dispatcher_host.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":7,"num_removed":1,"messages":[],"id":30027,"is_binary":false},"content/browser/speech/speech_recognizer.cc":{"status":"M    ","num_chunks":4,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":2,"messages":[],"id":30030,"is_binary":false},"media/audio/audio_manager_base.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":60,"num_removed":19,"messages":[],"id":30043,"is_binary":false},"content/browser/renderer_host/media/media_stream_dispatcher_host_unittest.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":1,"messages":[],"id":30018,"is_binary":false},"content/browser/renderer_host/render_process_host_impl.cc":{"status":"M    ","num_chunks":5,"no_base_file":false,"property_changes":"","num_added":42,"num_removed":50,"messages":[],"id":30022,"is_binary":false},"media/audio/linux/audio_manager_linux.h":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":2,"num_removed":3,"messages":[],"id":30057,"is_binary":false},"media/audio/audio_output_proxy.cc":{"status":"M    ","num_chunks":2,"no_base_file":false,"property_changes":"","num_added":9,"num_removed":4,"messages":[],"id":30050,"is_binary":false},"content/browser/renderer_host/media/media_stream_manager.h":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":5,"num_removed":1,"messages":[],"id":30020,"is_binary":false},"content/browser/speech/speech_recognizer_unittest.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":4,"messages":[],"id":30032,"is_binary":false},"content/browser/renderer_host/media/media_stream_manager.cc":{"status":"M    ","num_chunks":3,"no_base_file":false,"property_changes":"","num_added":6,"num_removed":3,"messages":[],"id":30019,"is_binary":false}},"owner_email":"tommi@chromium.org","owner":"tommi","message":"Addressing comments from Andrew","try_job_results":[{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=linux&number=7169","timestamp":"2011-12-12 16:44:05.174065","builder":"linux","clobber":null,"project":null,"reason":null,"result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIyCxIFSXNzdWUY3JqaBAwLEghQYXRjaFNldBjJ4gEMCxIMVHJ5Sm9iUmVzdWx0GLHnAgw","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=mac&number=7061","timestamp":"2011-12-12 16:44:05.174065","builder":"mac","clobber":null,"project":null,"reason":null,"result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIyCxIFSXNzdWUY3JqaBAwLEghQYXRjaFNldBjJ4gEMCxIMVHJ5Sm9iUmVzdWx0GLLnAgw","requester":null,"buildnumber":null,"revision":null},{"parent_name":null,"tests":[],"slave":null,"url":"http://build.chromium.org/p/tryserver.chromium/buildstatus?builder=win&number=7519","timestamp":"2011-12-12 16:44:05.174065","builder":"win","clobber":null,"project":null,"reason":null,"result":"2","key":"ahdzfmNocm9taXVtY29kZXJldmlldy1ocnIyCxIFSXNzdWUY3JqaBAwLEghQYXRjaFNldBjJ4gEMCxIMVHJ5Sm9iUmVzdWx0GLPnAgw","requester":null,"buildnumber":null,"revision":null}],"created":"2011-12-10 00:10:50.392502","url":null,"num_comments":6,"modified":"2012-01-13 14:35:42.117472","patchset":29001,"issue":8818012}